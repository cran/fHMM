<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Model estimation</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Model estimation</h1>



<p>The {fHMM} package fits a hidden Markov model via the maximum-likelihood method, i.e. by numerically maximizing the likelihood function. This vignette<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> derives the likelihood formula, discusses challenges associated with the likelihood maximization and presents the model estimation workflow.</p>
<div id="likelihood-evaluation-using-the-forward-algorithm" class="section level2">
<h2>Likelihood evaluation using the forward algorithm</h2>
<p>Deriving the likelihood function of an hidden Markov model is part of the hierarchical case, hence the following only discusses the general case.</p>
<p>An HHMM can be treated as an HMM with two conditionally independent data streams; the coarse-scale observations on the one hand and the corresponding chunk of fine-scale observations connected to a fine-scale HMM on the other hand. To derive the likelihood of an HHMM, we start by computing the likelihood of each chunk of fine-scale observations being generated by each fine-scale HMM.</p>
<p>To fit the <span class="math inline">\(i\)</span>-th fine-scale HMM, with model parameters <span class="math inline">\(\theta^{*(i)}=(\delta^{*(i)}, \Gamma^{*(i)},(f^{*(i,k)})_k)\)</span> to the <span class="math inline">\(t\)</span>-th chunk of fine-scale observations, which is denoted by <span class="math inline">\((X_{t,t^*})_{t^*}\)</span>, we consider the fine-scale forward probabilities <span class="math display">\[\begin{align*}
\alpha^{*(i)}_{k,t^*}=f^{*(i)}(X^*_{t,1},\dots,X^*_{t,t^*}, S^*_{t,t^*}=k),
\end{align*}\]</span> where <span class="math inline">\(t^*=1,\dots,T^*\)</span> and <span class="math inline">\(k=1,\dots,N^*\)</span>. Using the fine-scale forward probabilities, the fine-scale likelihoods can be obtained from the law of total probability as <span class="math display">\[\begin{align*}
\mathcal{L}^\text{HMM}(\theta^{*(i)}\mid (X^*_{t,t^*})_{t^*})=\sum_{k=1}^{N^*}\alpha^{*(i)}_{k,T^*}.
\end{align*}\]</span> The forward probabilities can be calculated in a recursively as <span class="math display">\[\begin{align*}
\alpha^{*(i)}_{k,1} &amp;= \delta^{*(i)}_k f^{*(i,k)}(X^*_{t,1}), \\
\alpha^{*(i)}_{k,t^*} &amp;= f^{*(i,k)}(X^*_{t,t^*})\sum_{j=1}^{N^*}\gamma^{*(i)}_{jk}\alpha^{*(i)}_{j,t^*-1}, \quad t^*=2,\dots,T^*.
\end{align*}\]</span></p>
<p>The transition from the likelihood function of an HMM to the likelihood function of an HHMM is straightforward: Consider the coarse-scale forward probabilities <span class="math display">\[\begin{align*}
\alpha_{i,t}=f(X_1,\dots,X_t,(X^*_{1,t^*})_{t^*},\dots,(X^*_{t,t^*})_{t^*}, S_t=i),
\end{align*}\]</span> where <span class="math inline">\(t=1,\dots,T\)</span> and <span class="math inline">\(i=1,\dots,N\)</span>. The likelihood function of the HHMM results as <span class="math display">\[\begin{align*}
\mathcal{L}^\text{HHMM}(\theta,(\theta^{*(i)})_i\mid (X_t)_t,((X^*_{t,t^*})_{t^*})_t)=\sum_{i=1}^{N}\alpha_{i,T}.
\end{align*}\]</span> The coarse-scale forward probabilities can be calculated similarly by applying the recursive scheme <span class="math display">\[\begin{align*}
\alpha_{i,1} &amp;= \delta_i \mathcal{L}^\text{HMM}(\theta^{*(i)}\mid (X^*_{1,t^*})_{t^*})f^{(i)}(X_1), \\
\alpha_{i,t} &amp;= \mathcal{L}^\text{HMM}(\theta^{*(i)}\mid (X^*_{t,t^*})_{t^*}) f^{(i)}(X_t)\sum_{j=1}^{N}\gamma_{ji}\alpha_{j,t-1}, \quad t=2,\dots,T.
\end{align*}\]</span></p>
</div>
<div id="challenges-associated-with-the-likelihood-maximization" class="section level2">
<h2>Challenges associated with the likelihood maximization</h2>
<p>To account for parameter constraints associated with the transition probabilities (and potentially the parameters of the state-dependent distributions), we use parameter transformations. To ensure that the entries of the t.p.m.s fulfill non-negativity and the unity condition, we estimate unconstrained values <span class="math inline">\((\eta_{ij})_{i\neq j}\)</span> for the non-diagonal entries of <span class="math inline">\(\Gamma\)</span> and derive the probabilities using the multinomial logit link <span class="math display">\[\begin{align*}
\gamma_{ij}=\frac{\exp[\eta_{ij}]}{1+\sum_{k\neq i}\exp[\eta_{ik}]},~i\neq j
\end{align*}\]</span> rather than estimating the probabilities <span class="math inline">\((\gamma_{ij})_{i,j}\)</span> directly. The diagonal entries result from the unity condition as <span class="math display">\[\begin{align*}
\gamma_{ii}=1-\sum_{j\neq i}\gamma_{ij}.
\end{align*}\]</span> Furthermore, variances are strictly positive, which can be achieved by applying an exponential transformation to the unconstrained estimator.</p>
<p>When numerically maximizing the likelihood using some Newton-Raphson-type method, we often face numerical under- or overflow, which can be addressed by maximizing the logarithm of the likelihood and incorporating constants in a conducive way (see <span class="citation"><a href="#ref-zuc16" role="doc-biblioref">Zucchini, MacDonald, and Langrock</a> (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span> and <span class="citation"><a href="#ref-oel21" role="doc-biblioref">Oelschläger and Adam</a> (<a href="#ref-oel21" role="doc-biblioref">2021</a>)</span> for details).</p>
<p>As the likelihood is maximized with respect to a relatively large number of parameters, the obtained maximum can be a local rather than the global one. To avoid this problem, it is recommended to run the maximization multiple times from different, possibly randomly selected starting points, and to choose the model that corresponds to the highest likelihood (see <span class="citation"><a href="#ref-zuc16" role="doc-biblioref">Zucchini, MacDonald, and Langrock</a> (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span> and <span class="citation"><a href="#ref-oel21" role="doc-biblioref">Oelschläger and Adam</a> (<a href="#ref-oel21" role="doc-biblioref">2021</a>)</span> for details).</p>
</div>
<div id="application" class="section level2">
<h2>Application</h2>
<p>For illustration, we fit a 3-state HMM with state-dependent t-distributions to the DAX data that we prepared in the previous vignette on data management:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">states =</span> <span class="dv">3</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sdds   =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> <span class="fu">list</span>(<span class="at">file        =</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;dax.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;fHMM&quot;</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">date_column =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data_column =</span> <span class="st">&quot;Close&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">from        =</span> <span class="st">&quot;2000-01-01&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">to          =</span> <span class="st">&quot;2021-12-31&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">logreturns  =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit    =</span> <span class="fu">list</span>(<span class="st">&quot;runs&quot;</span> <span class="ot">=</span> <span class="dv">100</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">set_controls</span>(controls)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">prepare_data</span>(controls)</span></code></pre></div>
<p>The <code>data</code> object can be directly passed to the <code>fit_model()</code> function that numerically maximizes the model’s (log-) likelihood function <code>runs = 100</code> times.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> This task can be parallelized by setting the <code>ncluster</code> argument.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dax_model_3t <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(data, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The estimated model is saved in the {fHMM} package and can be accessed as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dax_model_3t)</span></code></pre></div>
<p>Calling the <code>summary()</code> method provides an overview of the model fit, whereas <code>coef()</code> returns a data frame of the estimated model coefficients:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dax_model_3t)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Summary of fHMM model</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   simulated hierarchy       LL       AIC       BIC</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     FALSE     FALSE 16913.33 -33796.65 -33697.13</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; State-dependent distributions:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t() </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   lb   estimate        ub</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_2.1  1.394e-02  2.170e-02 3.357e-02</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_3.1  1.710e-06  1.697e-06 1.671e-06</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_1.2  1.659e-02  2.641e-02 4.179e-02</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_3.2  9.359e-03  1.740e-02 3.213e-02</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_1.3  1.259e-08  1.246e-08 1.227e-08</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_2.3  2.790e-03  5.146e-03 9.431e-03</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_1       9.610e-04  1.269e-03 1.576e-03</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_2      -7.955e-04 -2.517e-04 2.920e-04</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_3      -3.724e-03 -1.674e-03 3.765e-04</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_1    5.332e-03  5.774e-03 6.253e-03</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_2    1.269e-02  1.324e-02 1.381e-02</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_3    2.330e-02  2.563e-02 2.819e-02</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_1       3.964e+00  5.272e+00 7.012e+00</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_2       7.592e+04  7.593e+04 7.593e+04</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_3       5.501e+00  1.064e+01 2.058e+01</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; States:</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; decoded</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2    3 </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2177 2753  695 </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.523637 -0.659763  0.010355 -0.002319  0.673969  3.918940</span></span></code></pre></div>
<p>The estimated state-dependent distributions can be plotted as follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dax_model_3t, <span class="at">plot_type =</span> <span class="st">&quot;sdds&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<p>As mentioned above, the HMM likelihood function is prone to local optima. This effect can be visualized by plotting the log-likelihood value in the different optimization runs, where the best run is marked in red:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dax_model_3t, <span class="at">plot_type =</span> <span class="st">&quot;ll&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-oel21" class="csl-entry">
Oelschläger, L., and T. Adam. 2021. <span>“Detecting Bearish and Bullish Markets in Financial Time Series Using Hierarchical Hidden Markov Models.”</span> <em>Statistical Modelling</em>.
</div>
<div id="ref-zuc16" class="csl-entry">
Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. <span>“Hidden Markov Models for Time Series: An Introduction Using <span>R</span>, 2nd Edition.”</span> <em>Chapman and Hall/CRC</em>.
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>This vignette was build using R 4.1.0 with the {fHMM} 1.0.3 package.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>For convenience, the <code>controls</code> object is saved in <code>data</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>If you avoid any problems with clustering on your OS, use <code>ncluster = 1</code> which avoids any dependency on packages that provide clustering.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
