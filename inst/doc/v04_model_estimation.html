<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Model estimation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Model estimation</h1>



<p>The <code>{fHMM}</code> package fits a hidden Markov model via the
maximum-likelihood method, i.e. by numerically maximizing the likelihood
function. This vignette<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> derives the likelihood formula, discusses
challenges associated with the likelihood maximization and presents the
model estimation workflow.</p>
<div id="likelihood-evaluation-using-the-forward-algorithm" class="section level2">
<h2>Likelihood evaluation using the forward algorithm</h2>
<p>Deriving the likelihood function of an hidden Markov model is part of
the hierarchical case, hence the following only discusses the general
case.</p>
<p>An HHMM can be treated as an HMM with two conditionally independent
data streams; the coarse-scale observations on the one hand and the
corresponding chunk of fine-scale observations connected to a fine-scale
HMM on the other hand. To derive the likelihood of an HHMM, we start by
computing the likelihood of each chunk of fine-scale observations being
generated by each fine-scale HMM.</p>
<p>To fit the <span class="math inline">\(i\)</span>-th fine-scale HMM,
with model parameters <span class="math inline">\(\theta^{*(i)}=(\delta^{*(i)},
\Gamma^{*(i)},(f^{*(i,k)})_k)\)</span> to the <span class="math inline">\(t\)</span>-th chunk of fine-scale observations,
which is denoted by <span class="math inline">\((X_{t,t^*})_{t^*}\)</span>, we consider the
fine-scale forward probabilities <span class="math display">\[\begin{align*}
\alpha^{*(i)}_{k,t^*}=f^{*(i)}(X^*_{t,1},\dots,X^*_{t,t^*},
S^*_{t,t^*}=k),
\end{align*}\]</span> where <span class="math inline">\(t^*=1,\dots,T^*\)</span> and <span class="math inline">\(k=1,\dots,N^*\)</span>. Using the fine-scale
forward probabilities, the fine-scale likelihoods can be obtained from
the law of total probability as <span class="math display">\[\begin{align*}
\mathcal{L}^\text{HMM}(\theta^{*(i)}\mid
(X^*_{t,t^*})_{t^*})=\sum_{k=1}^{N^*}\alpha^{*(i)}_{k,T^*}.
\end{align*}\]</span> The forward probabilities can be calculated in a
recursively as <span class="math display">\[\begin{align*}
\alpha^{*(i)}_{k,1} &amp;= \delta^{*(i)}_k f^{*(i,k)}(X^*_{t,1}), \\
\alpha^{*(i)}_{k,t^*} &amp;=
f^{*(i,k)}(X^*_{t,t^*})\sum_{j=1}^{N^*}\gamma^{*(i)}_{jk}\alpha^{*(i)}_{j,t^*-1},
\quad t^*=2,\dots,T^*.
\end{align*}\]</span></p>
<p>The transition from the likelihood function of an HMM to the
likelihood function of an HHMM is straightforward: Consider the
coarse-scale forward probabilities <span class="math display">\[\begin{align*}
\alpha_{i,t}=f(X_1,\dots,X_t,(X^*_{1,t^*})_{t^*},\dots,(X^*_{t,t^*})_{t^*},
S_t=i),
\end{align*}\]</span> where <span class="math inline">\(t=1,\dots,T\)</span> and <span class="math inline">\(i=1,\dots,N\)</span>. The likelihood function of
the HHMM results as <span class="math display">\[\begin{align*}
\mathcal{L}^\text{HHMM}(\theta,(\theta^{*(i)})_i\mid
(X_t)_t,((X^*_{t,t^*})_{t^*})_t)=\sum_{i=1}^{N}\alpha_{i,T}.
\end{align*}\]</span> The coarse-scale forward probabilities can be
calculated similarly by applying the recursive scheme <span class="math display">\[\begin{align*}
\alpha_{i,1} &amp;= \delta_i \mathcal{L}^\text{HMM}(\theta^{*(i)}\mid
(X^*_{1,t^*})_{t^*})f^{(i)}(X_1), \\
\alpha_{i,t} &amp;= \mathcal{L}^\text{HMM}(\theta^{*(i)}\mid
(X^*_{t,t^*})_{t^*})
f^{(i)}(X_t)\sum_{j=1}^{N}\gamma_{ji}\alpha_{j,t-1}, \quad t=2,\dots,T.
\end{align*}\]</span></p>
</div>
<div id="challenges-associated-with-the-likelihood-maximization" class="section level2">
<h2>Challenges associated with the likelihood maximization</h2>
<p>To account for parameter constraints associated with the transition
probabilities (and potentially the parameters of the state-dependent
distributions), we use parameter transformations. To ensure that the
entries of the t.p.m.s fulfill non-negativity and the unity condition,
we estimate unconstrained values <span class="math inline">\((\eta_{ij})_{i\neq j}\)</span> for the
non-diagonal entries of <span class="math inline">\(\Gamma\)</span> and
derive the probabilities using the multinomial logit link <span class="math display">\[\begin{align*}
\gamma_{ij}=\frac{\exp[\eta_{ij}]}{1+\sum_{k\neq
i}\exp[\eta_{ik}]},~i\neq j
\end{align*}\]</span> rather than estimating the probabilities <span class="math inline">\((\gamma_{ij})_{i,j}\)</span> directly. The
diagonal entries result from the unity condition as <span class="math display">\[\begin{align*}
\gamma_{ii}=1-\sum_{j\neq i}\gamma_{ij}.
\end{align*}\]</span> Furthermore, variances are strictly positive,
which can be achieved by applying an exponential transformation to the
unconstrained estimator.</p>
<p>When numerically maximizing the likelihood using some
Newton-Raphson-type method, we often face numerical under- or overflow,
which can be addressed by maximizing the logarithm of the likelihood and
incorporating constants in a conducive way, see <span class="citation">Zucchini, MacDonald, and Langrock (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span> and <span class="citation">Oelschläger and Adam (<a href="#ref-oel21" role="doc-biblioref">2021</a>)</span> for details.</p>
<p>As the likelihood is maximized with respect to a relatively large
number of parameters, the obtained maximum can be a local rather than
the global one. To avoid this problem, it is recommended to run the
maximization multiple times from different, possibly randomly selected
starting points, and to choose the model that corresponds to the highest
likelihood, again see <span class="citation">Zucchini, MacDonald, and
Langrock (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span> and
<span class="citation">Oelschläger and Adam (<a href="#ref-oel21" role="doc-biblioref">2021</a>)</span> for details.</p>
</div>
<div id="application" class="section level2">
<h2>Application</h2>
<p>For illustration, we fit a 3-state HMM with state-dependent
t-distributions to the DAX data that we prepared in the previous
vignette on data management:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">states =</span> <span class="dv">3</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sdds   =</span> <span class="st">&quot;t&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data   =</span> <span class="fu">list</span>(<span class="at">file        =</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;dax.csv&quot;</span>, <span class="at">package =</span> <span class="st">&quot;fHMM&quot;</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">date_column =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">data_column =</span> <span class="st">&quot;Close&quot;</span>,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">from        =</span> <span class="st">&quot;2000-01-01&quot;</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">to          =</span> <span class="st">&quot;2021-12-31&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">logreturns  =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit    =</span> <span class="fu">list</span>(<span class="st">&quot;runs&quot;</span> <span class="ot">=</span> <span class="dv">100</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>controls <span class="ot">&lt;-</span> <span class="fu">set_controls</span>(controls)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">prepare_data</span>(controls)</span></code></pre></div>
<p>The <code>data</code> object can be directly passed to the
<code>fit_model()</code> function that numerically maximizes the model’s
(log-) likelihood function <code>runs = 100</code> times.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> This task can be
parallelized by setting the <code>ncluster</code> argument.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dax_model_3t <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(data, <span class="at">seed =</span> <span class="dv">1</span>, <span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The estimated model is saved in the <code>{fHMM}</code> package and
can be accessed as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(dax_model_3t)</span></code></pre></div>
<p>Calling the <code>summary()</code> method provides an overview of the
model fit, whereas <code>coef()</code> returns a data frame of the
estimated model coefficients:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dax_model_3t)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Summary of fHMM model</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   simulated hierarchy       LL       AIC       BIC</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     FALSE     FALSE 17649.52 -35269.03 -35168.84</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; State-dependent distributions:</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; t() </span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimates:</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   lb   estimate        ub</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_2.1  1.286e-02  2.007e-02 3.113e-02</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_3.1  1.208e-06  1.198e-06 1.180e-06</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_1.2  1.557e-02  2.489e-02 3.959e-02</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_3.2  1.036e-02  1.877e-02 3.378e-02</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_1.3  4.119e-07  4.080e-07 4.019e-07</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Gamma_2.3  2.935e-03  5.275e-03 9.422e-03</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_1       9.655e-04  1.271e-03 1.576e-03</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_2      -8.483e-04 -3.102e-04 2.278e-04</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; mu_3      -3.813e-03 -1.760e-03 2.932e-04</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_1    5.417e-03  5.853e-03 6.324e-03</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_2    1.278e-02  1.330e-02 1.384e-02</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma_3    2.348e-02  2.579e-02 2.832e-02</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_1       3.957e+00  5.198e+00 6.828e+00</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_2       3.870e+08  3.870e+08 3.870e+08</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; df_3       5.549e+00  1.078e+01 2.095e+01</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; States:</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; decoded</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1    2    3 </span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2278 2900  704 </span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residuals:</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. </span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; -3.519694 -0.658831  0.009613 -0.002206  0.669598  3.905726</span></span></code></pre></div>
<p>The estimated state-dependent distributions can be plotted as
follows:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dax_model_3t, <span class="at">plot_type =</span> <span class="st">&quot;sdds&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<p>As mentioned above, the HMM likelihood function is prone to local
optima. This effect can be visualized by plotting the log-likelihood
value in the different optimization runs, where the best run is marked
in red:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dax_model_3t, <span class="at">plot_type =</span> <span class="st">&quot;ll&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-oel21" class="csl-entry">
Oelschläger, L., and T. Adam. 2021. <span>“Detecting Bearish and Bullish
Markets in Financial Time Series Using Hierarchical Hidden Markov
Models.”</span> <em>Statistical Modelling</em>.
</div>
<div id="ref-zuc16" class="csl-entry">
Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. <span>“Hidden
Markov Models for Time Series: An Introduction Using <span>R</span>, 2nd
Edition.”</span> <em>Chapman and Hall/CRC</em>.
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>This vignette was build using R .4 with the
<code>{fHMM}</code> 1.1.0 package.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>For convenience, the <code>controls</code> object is
saved in <code>data</code>.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>If you avoid any problems with clustering on your OS,
use <code>ncluster = 1</code> which avoids any dependency on packages
that provide clustering.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
